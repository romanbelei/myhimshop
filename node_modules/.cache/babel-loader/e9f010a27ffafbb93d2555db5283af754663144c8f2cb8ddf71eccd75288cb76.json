{"ast":null,"code":"import{createAsyncThunk,createSlice}from\"@reduxjs/toolkit\";import axios from\"axios\";import{BASE_URL}from\"../../utils/constants\";export const createUser=createAsyncThunk(\"users/createUser\",async(payload,thunkAPI)=>{try{const res=await axios.post(\"\".concat(BASE_URL,\"/users\"),payload);return res.data;}catch(err){console.log(err);return thunkAPI.rejectWithValue(err);}});export const loginUser=createAsyncThunk(\"users/loginUser\",async(payload,thunkAPI)=>{try{const res=await axios.post(\"\".concat(BASE_URL,\"/auth/login\"),payload);const login=await axios(\"\".concat(BASE_URL,\"/auth/profile\"),{headers:{Authorization:\"Bearer \".concat(res.data.access_token)}});return login.data;}catch(err){console.log(err);return thunkAPI.rejectWithValue(err);}});export const updateUser=createAsyncThunk(\"users/updateUser\",async(payload,thunkAPI)=>{try{const res=await axios.put(\"\".concat(BASE_URL,\"/users/\").concat(payload.id),payload);return res.data;}catch(err){console.log(err);return thunkAPI.rejectWithValue(err);}});const addCurrentUser=(state,_ref)=>{let{payload}=_ref;state.currentUser=payload;};const userSlice=createSlice({name:\"user\",initialState:{currentUser:null,cart:[],isLoading:false,formType:\"signup\",showForm:false},reducers:{addItemToCart:(state,_ref2)=>{let{payload}=_ref2;let newCart=[...state.cart];const found=state.cart.find(_ref3=>{let{id}=_ref3;return id===payload.id;});if(found){newCart=newCart.map(item=>{return item.id===payload.id?{...item,quantity:payload.quantity||item.quantity+1}:item;});}else newCart.push({...payload,quantity:1});state.cart=newCart;},removeItemFromCart:(state,_ref4)=>{let{payload}=_ref4;state.cart=state.cart.filter(_ref5=>{let{id}=_ref5;return id!==payload;});},toggleForm:(state,_ref6)=>{let{payload}=_ref6;state.showForm=payload;},toggleFormType:(state,_ref7)=>{let{payload}=_ref7;state.formType=payload;}},extraReducers:builder=>{builder.addCase(createUser.fulfilled,addCurrentUser);builder.addCase(loginUser.fulfilled,addCurrentUser);builder.addCase(updateUser.fulfilled,addCurrentUser);}});export const{addItemToCart,removeItemFromCart,toggleForm,toggleFormType}=userSlice.actions;export default userSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","BASE_URL","createUser","payload","thunkAPI","res","post","concat","data","err","console","log","rejectWithValue","loginUser","login","headers","Authorization","access_token","updateUser","put","id","addCurrentUser","state","_ref","currentUser","userSlice","name","initialState","cart","isLoading","formType","showForm","reducers","addItemToCart","_ref2","newCart","found","find","_ref3","map","item","quantity","push","removeItemFromCart","_ref4","filter","_ref5","toggleForm","_ref6","toggleFormType","_ref7","extraReducers","builder","addCase","fulfilled","actions","reducer"],"sources":["D:/React/myhimshop/src/features/user/userSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport { BASE_URL } from \"../../utils/constants\";\r\n\r\nexport const createUser = createAsyncThunk(\r\n  \"users/createUser\",\r\n  async (payload, thunkAPI) => {\r\n    try {\r\n      const res = await axios.post(`${BASE_URL}/users`, payload);\r\n      return res.data;\r\n    } catch (err) {\r\n      console.log(err);\r\n      return thunkAPI.rejectWithValue(err);\r\n    }\r\n  }\r\n);\r\n\r\nexport const loginUser = createAsyncThunk(\r\n  \"users/loginUser\",\r\n  async (payload, thunkAPI) => {\r\n    try {\r\n      const res = await axios.post(`${BASE_URL}/auth/login`, payload);\r\n      const login = await axios(`${BASE_URL}/auth/profile`, {\r\n        headers: {\r\n          Authorization: `Bearer ${res.data.access_token}`,\r\n        },\r\n      });\r\n\r\n      return login.data;\r\n    } catch (err) {\r\n      console.log(err);\r\n      return thunkAPI.rejectWithValue(err);\r\n    }\r\n  }\r\n);\r\n\r\nexport const updateUser = createAsyncThunk(\r\n  \"users/updateUser\",\r\n  async (payload, thunkAPI) => {\r\n    try {\r\n      const res = await axios.put(`${BASE_URL}/users/${payload.id}`, payload);\r\n      return res.data;\r\n    } catch (err) {\r\n      console.log(err);\r\n      return thunkAPI.rejectWithValue(err);\r\n    }\r\n  }\r\n);\r\n\r\nconst addCurrentUser = (state, { payload }) => {\r\n  state.currentUser = payload;\r\n};\r\n\r\nconst userSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: {\r\n    currentUser: null,\r\n    cart: [],\r\n    isLoading: false,\r\n    formType: \"signup\",\r\n    showForm: false,\r\n  },\r\n  reducers: {\r\n    addItemToCart: (state, { payload }) => {\r\n      let newCart = [...state.cart];\r\n      const found = state.cart.find(({ id }) => id === payload.id);\r\n\r\n      if (found) {\r\n        newCart = newCart.map((item) => {\r\n          return item.id === payload.id\r\n            ? { ...item, quantity: payload.quantity || item.quantity + 1 }\r\n            : item;\r\n        });\r\n      } else newCart.push({ ...payload, quantity: 1 });\r\n\r\n      state.cart = newCart;\r\n    },\r\n    removeItemFromCart: (state, { payload }) => {\r\n      state.cart = state.cart.filter(({ id }) => id !== payload);\r\n    },\r\n    toggleForm: (state, { payload }) => {\r\n      state.showForm = payload;\r\n    },\r\n    toggleFormType: (state, { payload }) => {\r\n      state.formType = payload;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder.addCase(createUser.fulfilled, addCurrentUser);\r\n    builder.addCase(loginUser.fulfilled, addCurrentUser);\r\n    builder.addCase(updateUser.fulfilled, addCurrentUser);\r\n  },\r\n});\r\n\r\nexport const { addItemToCart, removeItemFromCart, toggleForm, toggleFormType } =\r\n  userSlice.actions;\r\n\r\nexport default userSlice.reducer;\r\n"],"mappings":"AAAA,OAASA,gBAAgB,CAAEC,WAAW,KAAQ,kBAAkB,CAChE,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,uBAAuB,CAEhD,MAAO,MAAM,CAAAC,UAAU,CAAGJ,gBAAgB,CACxC,kBAAkB,CAClB,MAAOK,OAAO,CAAEC,QAAQ,GAAK,CAC3B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAL,KAAK,CAACM,IAAI,IAAAC,MAAA,CAAIN,QAAQ,WAAUE,OAAO,CAAC,CAC1D,MAAO,CAAAE,GAAG,CAACG,IAAI,CACjB,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAChB,MAAO,CAAAL,QAAQ,CAACQ,eAAe,CAACH,GAAG,CAAC,CACtC,CACF,CACF,CAAC,CAED,MAAO,MAAM,CAAAI,SAAS,CAAGf,gBAAgB,CACvC,iBAAiB,CACjB,MAAOK,OAAO,CAAEC,QAAQ,GAAK,CAC3B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAL,KAAK,CAACM,IAAI,IAAAC,MAAA,CAAIN,QAAQ,gBAAeE,OAAO,CAAC,CAC/D,KAAM,CAAAW,KAAK,CAAG,KAAM,CAAAd,KAAK,IAAAO,MAAA,CAAIN,QAAQ,kBAAiB,CACpDc,OAAO,CAAE,CACPC,aAAa,WAAAT,MAAA,CAAYF,GAAG,CAACG,IAAI,CAACS,YAAY,CAChD,CACF,CAAC,CAAC,CAEF,MAAO,CAAAH,KAAK,CAACN,IAAI,CACnB,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAChB,MAAO,CAAAL,QAAQ,CAACQ,eAAe,CAACH,GAAG,CAAC,CACtC,CACF,CACF,CAAC,CAED,MAAO,MAAM,CAAAS,UAAU,CAAGpB,gBAAgB,CACxC,kBAAkB,CAClB,MAAOK,OAAO,CAAEC,QAAQ,GAAK,CAC3B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAL,KAAK,CAACmB,GAAG,IAAAZ,MAAA,CAAIN,QAAQ,YAAAM,MAAA,CAAUJ,OAAO,CAACiB,EAAE,EAAIjB,OAAO,CAAC,CACvE,MAAO,CAAAE,GAAG,CAACG,IAAI,CACjB,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAChB,MAAO,CAAAL,QAAQ,CAACQ,eAAe,CAACH,GAAG,CAAC,CACtC,CACF,CACF,CAAC,CAED,KAAM,CAAAY,cAAc,CAAGA,CAACC,KAAK,CAAAC,IAAA,GAAkB,IAAhB,CAAEpB,OAAQ,CAAC,CAAAoB,IAAA,CACxCD,KAAK,CAACE,WAAW,CAAGrB,OAAO,CAC7B,CAAC,CAED,KAAM,CAAAsB,SAAS,CAAG1B,WAAW,CAAC,CAC5B2B,IAAI,CAAE,MAAM,CACZC,YAAY,CAAE,CACZH,WAAW,CAAE,IAAI,CACjBI,IAAI,CAAE,EAAE,CACRC,SAAS,CAAE,KAAK,CAChBC,QAAQ,CAAE,QAAQ,CAClBC,QAAQ,CAAE,KACZ,CAAC,CACDC,QAAQ,CAAE,CACRC,aAAa,CAAEA,CAACX,KAAK,CAAAY,KAAA,GAAkB,IAAhB,CAAE/B,OAAQ,CAAC,CAAA+B,KAAA,CAChC,GAAI,CAAAC,OAAO,CAAG,CAAC,GAAGb,KAAK,CAACM,IAAI,CAAC,CAC7B,KAAM,CAAAQ,KAAK,CAAGd,KAAK,CAACM,IAAI,CAACS,IAAI,CAACC,KAAA,MAAC,CAAElB,EAAG,CAAC,CAAAkB,KAAA,OAAK,CAAAlB,EAAE,GAAKjB,OAAO,CAACiB,EAAE,GAAC,CAE5D,GAAIgB,KAAK,CAAE,CACTD,OAAO,CAAGA,OAAO,CAACI,GAAG,CAAEC,IAAI,EAAK,CAC9B,MAAO,CAAAA,IAAI,CAACpB,EAAE,GAAKjB,OAAO,CAACiB,EAAE,CACzB,CAAE,GAAGoB,IAAI,CAAEC,QAAQ,CAAEtC,OAAO,CAACsC,QAAQ,EAAID,IAAI,CAACC,QAAQ,CAAG,CAAE,CAAC,CAC5DD,IAAI,CACV,CAAC,CAAC,CACJ,CAAC,IAAM,CAAAL,OAAO,CAACO,IAAI,CAAC,CAAE,GAAGvC,OAAO,CAAEsC,QAAQ,CAAE,CAAE,CAAC,CAAC,CAEhDnB,KAAK,CAACM,IAAI,CAAGO,OAAO,CACtB,CAAC,CACDQ,kBAAkB,CAAEA,CAACrB,KAAK,CAAAsB,KAAA,GAAkB,IAAhB,CAAEzC,OAAQ,CAAC,CAAAyC,KAAA,CACrCtB,KAAK,CAACM,IAAI,CAAGN,KAAK,CAACM,IAAI,CAACiB,MAAM,CAACC,KAAA,MAAC,CAAE1B,EAAG,CAAC,CAAA0B,KAAA,OAAK,CAAA1B,EAAE,GAAKjB,OAAO,GAAC,CAC5D,CAAC,CACD4C,UAAU,CAAEA,CAACzB,KAAK,CAAA0B,KAAA,GAAkB,IAAhB,CAAE7C,OAAQ,CAAC,CAAA6C,KAAA,CAC7B1B,KAAK,CAACS,QAAQ,CAAG5B,OAAO,CAC1B,CAAC,CACD8C,cAAc,CAAEA,CAAC3B,KAAK,CAAA4B,KAAA,GAAkB,IAAhB,CAAE/C,OAAQ,CAAC,CAAA+C,KAAA,CACjC5B,KAAK,CAACQ,QAAQ,CAAG3B,OAAO,CAC1B,CACF,CAAC,CACDgD,aAAa,CAAGC,OAAO,EAAK,CAC1BA,OAAO,CAACC,OAAO,CAACnD,UAAU,CAACoD,SAAS,CAAEjC,cAAc,CAAC,CACrD+B,OAAO,CAACC,OAAO,CAACxC,SAAS,CAACyC,SAAS,CAAEjC,cAAc,CAAC,CACpD+B,OAAO,CAACC,OAAO,CAACnC,UAAU,CAACoC,SAAS,CAAEjC,cAAc,CAAC,CACvD,CACF,CAAC,CAAC,CAEF,MAAO,MAAM,CAAEY,aAAa,CAAEU,kBAAkB,CAAEI,UAAU,CAAEE,cAAe,CAAC,CAC5ExB,SAAS,CAAC8B,OAAO,CAEnB,cAAe,CAAA9B,SAAS,CAAC+B,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}