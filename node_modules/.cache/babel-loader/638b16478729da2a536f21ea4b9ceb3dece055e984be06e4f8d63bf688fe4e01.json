{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useSelector}from\"react-redux\";import{useParams}from\"react-router-dom\";import{useGetProductsQuery}from\"../../features/api/apiSlice\";import styles from\"../../styles/Category.module.css\";import Products from\"../Products/Products\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Category=()=>{const{id}=useParams();const{list}=useSelector(_ref=>{let{categories}=_ref;return categories;});const defaultValues={title:\"\",price_min:0,price_max:0};const defaultParams={categoryId:id,limit:5,offset:0,...defaultValues};const[isEnd,setEnd]=useState(false);const[cat,setCat]=useState(null);const[items,setItems]=useState([]);const[values,setValues]=useState(defaultValues);const[params,setParams]=useState(defaultParams);const{data=[],isLoading,isSuccess}=useGetProductsQuery(params);useEffect(()=>{if(!id)return;setValues(defaultValues);setItems([]);setEnd(false);setParams({...defaultParams,categoryId:id});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[id]);useEffect(()=>{if(isLoading)return;if(!data.length)return setEnd(true);setItems(_items=>[..._items,...data]);},[data,isLoading]);useEffect(()=>{if(!id||!list.length)return;const category=list.find(item=>item.id===id*1);setCat(category);},[list,id]);const handleChange=_ref2=>{let{target:{value,name}}=_ref2;setValues({...values,[name]:value});};const handleSubmit=e=>{e.preventDefault();setItems([]);setEnd(false);setParams({...defaultParams,...values});};const handleReset=()=>{setValues(defaultValues);setParams(defaultParams);setEnd(false);};return/*#__PURE__*/_jsxs(\"section\",{className:styles.wrapper,children:[/*#__PURE__*/_jsx(\"h2\",{className:styles.title,children:cat===null||cat===void 0?void 0:cat.name}),/*#__PURE__*/_jsxs(\"form\",{className:styles.filters,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.filter,children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",onChange:handleChange,placeholder:\"Product name\",value:values.title})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.filter,children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price_min\",onChange:handleChange,placeholder:\"0\",value:values.price_min}),/*#__PURE__*/_jsx(\"span\",{children:\"Price from\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.filter,children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price_max\",onChange:handleChange,placeholder:\"0\",value:values.price_max}),/*#__PURE__*/_jsx(\"span\",{children:\"Price to\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",hidden:true})]}),isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"preloader\",children:\"Loading...\"}):!isSuccess||!items.length?/*#__PURE__*/_jsxs(\"div\",{className:styles.back,children:[/*#__PURE__*/_jsx(\"span\",{children:\"No results\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleReset,children:\"Reset\"})]}):/*#__PURE__*/_jsx(Products,{title:\"\",products:items,style:{padding:0},amount:items.length}),!isEnd&&/*#__PURE__*/_jsx(\"div\",{className:styles.more,children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setParams({...params,offset:params.offset+params.limit}),children:\"See more\"})})]});};export default Category;","map":{"version":3,"names":["React","useEffect","useState","useSelector","useParams","useGetProductsQuery","styles","Products","jsx","_jsx","jsxs","_jsxs","Category","id","list","_ref","categories","defaultValues","title","price_min","price_max","defaultParams","categoryId","limit","offset","isEnd","setEnd","cat","setCat","items","setItems","values","setValues","params","setParams","data","isLoading","isSuccess","length","_items","category","find","item","handleChange","_ref2","target","value","name","handleSubmit","e","preventDefault","handleReset","className","wrapper","children","filters","onSubmit","filter","type","onChange","placeholder","hidden","back","onClick","products","style","padding","amount","more"],"sources":["D:/React/myhimshop/src/components/Categories/Category.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useParams } from \"react-router-dom\";\n\nimport { useGetProductsQuery } from \"../../features/api/apiSlice\";\n\nimport styles from \"../../styles/Category.module.css\";\n\nimport Products from \"../Products/Products\";\n\nconst Category = () => {\n  const { id } = useParams();\n  const { list } = useSelector(({ categories }) => categories);\n\n  const defaultValues = {\n    title: \"\",\n    price_min: 0,\n    price_max: 0,\n  };\n\n  const defaultParams = {\n    categoryId: id,\n    limit: 5,\n    offset: 0,\n    ...defaultValues,\n  };\n\n  const [isEnd, setEnd] = useState(false);\n  const [cat, setCat] = useState(null);\n  const [items, setItems] = useState([]);\n  const [values, setValues] = useState(defaultValues);\n  const [params, setParams] = useState(defaultParams);\n\n  const { data = [], isLoading, isSuccess } = useGetProductsQuery(params);\n\n  useEffect(() => {\n    if (!id) return;\n\n    setValues(defaultValues);\n    setItems([]);\n    setEnd(false);\n    setParams({ ...defaultParams, categoryId: id });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  useEffect(() => {\n    if (isLoading) return;\n\n    if (!data.length) return setEnd(true);\n\n    setItems((_items) => [..._items, ...data]);\n  }, [data, isLoading]);\n\n  useEffect(() => {\n    if (!id || !list.length) return;\n\n    const category = list.find((item) => item.id === id * 1);\n\n    setCat(category);\n  }, [list, id]);\n\n  const handleChange = ({ target: { value, name } }) => {\n    setValues({ ...values, [name]: value });\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    setItems([]);\n    setEnd(false);\n    setParams({ ...defaultParams, ...values });\n  };\n\n  const handleReset = () => {\n    setValues(defaultValues);\n    setParams(defaultParams);\n    setEnd(false);\n  };\n\n  return (\n    <section className={styles.wrapper}>\n      <h2 className={styles.title}>{cat?.name}</h2>\n\n      <form className={styles.filters} onSubmit={handleSubmit}>\n        <div className={styles.filter}>\n          <input\n            type=\"text\"\n            name=\"title\"\n            onChange={handleChange}\n            placeholder=\"Product name\"\n            value={values.title}\n          />\n        </div>\n        <div className={styles.filter}>\n          <input\n            type=\"number\"\n            name=\"price_min\"\n            onChange={handleChange}\n            placeholder=\"0\"\n            value={values.price_min}\n          />\n          <span>Price from</span>\n        </div>\n        <div className={styles.filter}>\n          <input\n            type=\"number\"\n            name=\"price_max\"\n            onChange={handleChange}\n            placeholder=\"0\"\n            value={values.price_max}\n          />\n          <span>Price to</span>\n        </div>\n\n        <button type=\"submit\" hidden />\n      </form>\n\n      {isLoading ? (\n        <div className=\"preloader\">Loading...</div>\n      ) : !isSuccess || !items.length ? (\n        <div className={styles.back}>\n          <span>No results</span>\n          <button onClick={handleReset}>Reset</button>\n        </div>\n      ) : (\n        <Products\n          title=\"\"\n          products={items}\n          style={{ padding: 0 }}\n          amount={items.length}\n        />\n      )}\n\n      {!isEnd && (\n        <div className={styles.more}>\n          <button\n            onClick={() =>\n              setParams({ ...params, offset: params.offset + params.limit })\n            }\n          >\n            See more\n          </button>\n        </div>\n      )}\n    </section>\n  );\n};\n\nexport default Category;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}